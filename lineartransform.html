<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="description" content="Matrix Representation of Linear Transformation Calculator">
    <meta name="keywords" content="Linear Transformation, Matrix Representation, Change of Basis">
   <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LEQE004C92"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LEQE004C92');
</script>
    <meta charset="UTF-8" />
    <title>Matrix Representation of Linear Transformation Calculator</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        .katex-display { margin: 1em 0; overflow-x: auto; }
        .error-message { color: #B22222; font-weight: bold; text-align: center; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <nav class="fixed top-0 left-0 w-full z-10 bg-white shadow-md">
        <div class="max-w-4xl mx-auto px-4 py-2">
            <ul class="flex justify-center space-x-4">
                <li><a href="index.html" class="text-indigo-500 hover:text-blue-600 font-bold text-xl">Home</a></li>
                <li><a href="teaching.html" class="text-indigo-500 hover:text-blue-600 font-bold text-xl">Teaching</a></li>
                <li><a href="projects.html" class="text-indigo-500 hover:text-blue-600 font-bold text-xl">Diff Eq</a></li>
                <li><a href="linear.html" class="text-indigo-500 hover:text-blue-600 font-bold text-xl">Linear Algebra</a></li>
				<li><a href="numerical.html" class="text-indigo-500 hover:text-blue-600 font-bold text-xl">Numerical Methods</a></li>

            </ul>
        </div>
    </nav>
    <div class="bg-white p-6 rounded-lg shadow-md max-w-4xl w-full mx-auto mt-8">
        <h2 class="text-2xl font-bold mb-4 text-center text-gray-800 latex">Matrix Representation of a Linear Transformation</h2>
        <p class="text-center text-gray-600 mb-4">Given a linear transformation $T: \mathbb{R}^m \to \mathbb{R}^n$ with <strong>non-standard bases</strong>, this calculator computes the matrix representation of $T$ relative to these bases.<br><br>
        Let $\mathcal{B} = \{v_1, \ldots, v_m\}$ be a basis for the <strong>domain</strong> $\mathbb{R}^m$ and $\mathcal{C} = \{u_1, \ldots, u_n\}$ be a basis for the <strong>codomain</strong> $\mathbb{R}^n$.<br>
        The matrix $\mathbf{V}$ has columns $v_1, \ldots, v_m$ (domain basis), $\mathbf{U}$ has columns $u_1, \ldots, u_n$ (codomain basis), and $\mathbf{A}$ is the standard matrix of $T$.<br>
        The matrix representation relative to these bases is: $$\mathbf{B} = \mathbf{U}^{-1} \mathbf{A} \mathbf{V}$$
        <span class="text-sm italic">This means if $[\mathbf{x}]_{\mathcal{B}}$ are coordinates in basis $\mathcal{B}$, then $[T(\mathbf{x})]_{\mathcal{C}} = \mathbf{B} \, [\mathbf{x}]_{\mathcal{B}}$ gives coordinates in basis $\mathcal{C}$.</span></p>
        <div class="bg-gray-50 p-4 rounded-lg mb-6 flex justify-center items-center space-x-4">
            <span class="text-gray-700">Domain dim $m$:</span>
            <input type="number" id="m" min="1" required class="w-12 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
            <span class="text-gray-700">Codomain dim $n$:</span>
            <input type="number" id="n" min="1" required class="w-12 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button type="button" onclick="generateMatrices()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition duration-300">Generate Matrices</button>
            <button type="button" onclick="loadExample()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition duration-300">Load Example</button>
        </div>
        <div id="matrixInput" class="mb-6 overflow-x-auto"></div>
        <div class="flex justify-center mb-6 space-x-6">
            <span class="text-gray-700">Display Values as:</span>
            <label class="flex items-center">
                <input type="radio" name="displayMode" value="fraction" checked class="mr-2">
                <span>Fraction</span>
            </label>
            <label class="flex items-center">
                <input type="radio" name="displayMode" value="decimal" class="mr-2">
                <span>Decimal</span>
            </label>
        </div>
        <div class="flex justify-center space-x-4 mb-6">
            <button id="computeBtn" type="button" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition duration-300 w-1/3">Compute</button>
            <button id="clearBtn" type="button" class="bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600 transition duration-300 w-1/3">Clear All</button>
        </div>
        <div id="result" class="mt-6 p-4 bg-gray-50 rounded-lg"></div>
        <div class="mt-6 border-t pt-4 text-center text-gray-500 text-sm">
            &copy; 2025 Shelvean Kapita: kapita@tamu.edu <br> Last modified: July 24, 2025
            <br>
            Licensed under the <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>.
        </div>
    </div>
    <script>
        // Initialize KaTeX rendering after scripts are loaded
        window.onload = function() {
            renderMathInElement(document.body, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "\\(", right: "\\)", display: false },
                    { left: "$", right: "$", display: false }
                ],
                throwOnError: false,
                errorCallback: function(err) {
                    console.error("KaTeX rendering error:", err);
                }
            });
        };

        var currentDisplayMode = "fraction";
        document.querySelectorAll('input[name="displayMode"]').forEach(function(radio) {
            radio.addEventListener("change", function() {
                currentDisplayMode = this.value;
            });
        });

        function generateMatrices() {
            var m = parseInt(document.getElementById("m").value, 10);
            var n = parseInt(document.getElementById("n").value, 10);
            if (isNaN(m) || m <= 0 || isNaN(n) || n <= 0) {
                alert("Please enter valid positive integers for m and n.");
                return;
            }
            var matrixDiv = document.getElementById("matrixInput");
            matrixDiv.innerHTML = "";
            var statementDiv = document.createElement("div");
            statementDiv.className = "text-center mb-4";
            var statement = document.createElement("div");
            statement.className = "latex";
            statement.textContent = `$$ \\begin{array}{c} \\text{Compute the matrix representation } \\mathbf{B} = \\mathbf{U}^{-1} \\mathbf{A} \\mathbf{V} \\text{ where } \\\\ \\mathbf{V} \\text{ is the } ${m} \\times ${m} \\text{ domain space (initial) basis matrix,} \\\\ \\mathbf{A} \\text{ is the } ${n} \\times ${m} \\text{ matrix representation of } L \\text{ in the standard basis,} \\\\ \\mathbf{U} \\text{ is the } ${n} \\times ${n} \\text{ image space (final) basis matrix} \\end{array} $$`;
            statementDiv.appendChild(statement);
            matrixDiv.appendChild(statementDiv);
            var flexDiv = document.createElement("div");
            flexDiv.className = "flex justify-center space-x-8";
            // Matrix V (initial basis)
            var vDiv = document.createElement("div");
            var vLabel = document.createElement("p");
            vLabel.className = "text-center font-semibold latex";
            vLabel.textContent = "Matrix $\\mathbf{V}$ (domain space initial basis)";
            vDiv.appendChild(vLabel);
            var vTable = document.createElement("table");
            vTable.className = "border-collapse";
            for (var i = 0; i < m; i++) {
                var tr = document.createElement("tr");
                for (var j = 0; j < m; j++) {
                    var td = document.createElement("td");
                    td.className = "p-1";
                    var input = document.createElement("input");
                    input.type = "text";
                    input.className = "matrix-cell w-16 p-2 text-center border-2 border-gray-300 hover:border-blue-500 hover:border-4 rounded-md focus:outline-none";
                    input.id = "V_" + i + "_" + j;
                    td.appendChild(input);
                    tr.appendChild(td);
                }
                vTable.appendChild(tr);
            }
            vDiv.appendChild(vTable);
            flexDiv.appendChild(vDiv);
            // Matrix A (standard matrix of L)
            var aDiv = document.createElement("div");
            var aLabel = document.createElement("p");
            aLabel.className = "text-center font-semibold latex";
            aLabel.textContent = "Matrix $\\mathbf{A}$ (standard matrix of $L$)";
            aDiv.appendChild(aLabel);
            var aTable = document.createElement("table");
            aTable.className = "border-collapse";
            for (var i = 0; i < n; i++) {
                var tr = document.createElement("tr");
                for (var j = 0; j < m; j++) {
                    var td = document.createElement("td");
                    td.className = "p-1";
                    var input = document.createElement("input");
                    input.type = "text";
                    input.className = "matrix-cell w-16 p-2 text-center border-2 border-gray-300 hover:border-blue-500 hover:border-4 rounded-md focus:outline-none";
                    input.id = "A_" + i + "_" + j;
                    td.appendChild(input);
                    tr.appendChild(td);
                }
                aTable.appendChild(tr);
            }
            aDiv.appendChild(aTable);
            flexDiv.appendChild(aDiv);
            // Matrix U (final basis)
            var uDiv = document.createElement("div");
            var uLabel = document.createElement("p");
            uLabel.className = "text-center font-semibold latex";
            uLabel.textContent = "Matrix $\\mathbf{U}$ (image space final basis)";
            uDiv.appendChild(uLabel);
            var uTable = document.createElement("table");
            uTable.className = "border-collapse";
            for (var i = 0; i < n; i++) {
                var tr = document.createElement("tr");
                for (var j = 0; j < n; j++) {
                    var td = document.createElement("td");
                    td.className = "p-1";
                    var input = document.createElement("input");
                    input.type = "text";
                    input.className = "matrix-cell w-16 p-2 text-center border-2 border-gray-300 hover:border-blue-500 hover:border-4 rounded-md focus:outline-none";
                    input.id = "U_" + i + "_" + j;
                    td.appendChild(input);
                    tr.appendChild(td);
                }
                uTable.appendChild(tr);
            }
            uDiv.appendChild(uTable);
            flexDiv.appendChild(uDiv);
            matrixDiv.appendChild(flexDiv);
            renderMathInElement(matrixDiv, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false }
                ],
                throwOnError: false,
                errorCallback: function(err) {
                    console.error("KaTeX rendering error in matrixInput:", err);
                }
            });
        }

        function clearAll() {
            document.getElementById("m").value = "";
            document.getElementById("n").value = "";
            document.getElementById("matrixInput").innerHTML = "";
            document.getElementById("result").innerHTML = "";
            document.querySelector('input[value="fraction"]').checked = true;
            currentDisplayMode = "fraction";
            renderMathInElement(document.body, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false }
                ],
                throwOnError: false,
                errorCallback: function(err) {
                    console.error("KaTeX rendering error in clearAll:", err);
                }
            });
        }
        document.getElementById("clearBtn").addEventListener("click", clearAll);

        function parseFraction(str) {
            str = str.trim();
            if (str.includes('/')) {
                let parts = str.split('/');
                if (parts.length === 2) {
                    let numerator = parseFloat(parts[0]);
                    let denominator = parseFloat(parts[1]);
                    if (!isNaN(numerator) && !isNaN(denominator) && denominator !== 0) {
                        return numerator / denominator;
                    }
                }
                return NaN;
            }
            return parseFloat(str);
        }

        function readMatrices() {
            var m = parseInt(document.getElementById("m").value, 10);
            var n = parseInt(document.getElementById("n").value, 10);
            if (isNaN(m) || m <= 0 || isNaN(n) || n <= 0) {
                alert("Please enter valid positive integers for m and n.");
                return null;
            }
            var U = [];
            for (var i = 0; i < n; i++) {
                var row = [];
                for (var j = 0; j < n; j++) {
                    var cell = document.getElementById("U_" + i + "_" + j);
                    var value = cell.value.trim();
                    var num = value === "" ? 0 : parseFraction(value);
                    if (isNaN(num)) {
                        alert("Please enter valid numbers or fractions in all cells of matrix U.");
                        return null;
                    }
                    row.push(num);
                }
                U.push(row);
            }
            var V = [];
            for (var i = 0; i < m; i++) {
                var row = [];
                for (var j = 0; j < m; j++) {
                    var cell = document.getElementById("V_" + i + "_" + j);
                    var value = cell.value.trim();
                    var num = value === "" ? 0 : parseFraction(value);
                    if (isNaN(num)) {
                        alert("Please enter valid numbers or fractions in all cells of matrix V.");
                        return null;
                    }
                    row.push(num);
                }
                V.push(row);
            }
            var A = [];
            for (var i = 0; i < n; i++) {
                var row = [];
                for (var j = 0; j < m; j++) {
                    var cell = document.getElementById("A_" + i + "_" + j);
                    var value = cell.value.trim();
                    var num = value === "" ? 0 : parseFraction(value);
                    if (isNaN(num)) {
                        alert("Please enter valid numbers or fractions in all cells of matrix A.");
                        return null;
                    }
                    row.push(num);
                }
                A.push(row);
            }
            return { U: U, V: V, A: A };
        }

        function isIdentity(mat) {
            var size = mat.length;
            if (size === 0) return false;
            if (mat[0].length !== size) return false;
            for (var i = 0; i < size; i++) {
                for (var j = 0; j < size; j++) {
                    var val = mat[i][j];
                    if (i === j) {
                        if (Math.abs(val - 1) > 1e-10) return false;
                    } else {
                        if (Math.abs(val) > 1e-10) return false;
                    }
                }
            }
            return true;
        }

        function matrixMultiply(A, B) {
            const rowsA = A.length;
            const colsA = A[0].length;
            const colsB = B[0].length;
            let C = Array.from({length: rowsA}, () => Array(colsB).fill(0));
            for (let i = 0; i < rowsA; i++) {
                for (let j = 0; j < colsB; j++) {
                    for (let k = 0; k < colsA; k++) {
                        C[i][j] += A[i][k] * B[k][j];
                    }
                }
            }
            return C;
        }

        function invertMatrix(M) {
            var n = M.length;
            if (M[0].length !== n) throw "Matrix not square";
            var A = M.map(row => row.slice());
            var I = [];
            for (var i = 0; i < n; i++) {
                var row = [];
                for (var j = 0; j < n; j++) {
                    row.push(i === j ? 1 : 0);
                }
                I.push(row);
            }
            for (var col = 0; col < n; col++) {
                var pivot = col;
                for (var i = col + 1; i < n; i++) {
                    if (Math.abs(A[i][col]) > Math.abs(A[pivot][col])) {
                        pivot = i;
                    }
                }
                if (Math.abs(A[pivot][col]) < 1e-12) {
                    throw "Matrix is singular and not invertible";
                }
                if (pivot !== col) {
                    var temp = A[col];
                    A[col] = A[pivot];
                    A[pivot] = temp;
                    temp = I[col];
                    I[col] = I[pivot];
                    I[pivot] = temp;
                }
                var piv = A[col][col];
                for (var j = 0; j < n; j++) {
                    A[col][j] /= piv;
                    I[col][j] /= piv;
                }
                for (var i = 0; i < n; i++) {
                    if (i !== col) {
                        var factor = A[i][col];
                        for (var j = 0; j < n; j++) {
                            A[i][j] -= factor * A[col][j];
                            I[i][j] -= factor * I[col][j];
                        }
                    }
                }
            }
            return I;
        }

        function computeMatrixRepresentation() {
            var input = readMatrices();
            if (input === null) return;
            var U = input.U;
            var V = input.V;
            var A = input.A;
            var m = V.length;
            var n = U.length;
            var resultDiv = document.getElementById("result");
            // Check if V is singular
            try {
                invertMatrix(V);
            } catch (e) {
                resultDiv.innerHTML = `<p class="error-message">Error: Matrix V is singular and not invertible.</p>`;
                return;
            }
            // Check if U is singular
            try {
                var invU = invertMatrix(U);
            } catch (e) {
                resultDiv.innerHTML = `<p class="error-message">Error: Matrix U is singular and not invertible.</p>`;
                return;
            }
            var temp = matrixMultiply(invU, A);
            var B = matrixMultiply(temp, V);
            var isUId = isIdentity(U);
            var isVId = isIdentity(V);
            var expr = "\\mathbf{B} = ";
            if (!isUId) expr += "\\mathbf{U}^{-1} ";
            expr += "\\mathbf{A}";
            if (!isVId) expr += " \\mathbf{V}";
            var latexRight;
            if (isUId && isVId && m === n && isIdentity(A)) {
                latexRight = "\\mathbf{I}";
            } else if (m === 1 && n === 1) {
                latexRight = formatNumber(B[0][0]);
            } else {
                latexRight = matrixToLatex(B);
            }
            resultDiv.innerHTML = `
                <p class="text-gray-700 text-center font-semibold">Matrix Representation:</p>
                <div class="latex">$$ ${expr} = ${latexRight} $$</div>
            `;
            renderMathInElement(resultDiv, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false }
                ],
                throwOnError: false,
                errorCallback: function(err) {
                    console.error("KaTeX rendering error in result:", err);
                }
            });
        }

        function matrixToLatex(matrix) {
            var latex = "\\begin{pmatrix} ";
            for (var i = 0; i < matrix.length; i++) {
                for (var j = 0; j < matrix[0].length; j++) {
                    latex += formatNumber(matrix[i][j]);
                    if (j < matrix[0].length - 1) latex += " & ";
                }
                if (i < matrix.length - 1) latex += " \\\\ ";
            }
            latex += " \\end{pmatrix}";
            return latex;
        }

        function toFraction(x, tolerance, maxIterations) {
            tolerance = tolerance || 1e-6;
            maxIterations = maxIterations || 20;
            if (x === 0) return "0";
            var sign = x < 0 ? -1 : 1;
            x = Math.abs(x);
            var h1 = 1, h2 = 0, k1 = 0, k2 = 1, b = x;
            for (var i = 0; i < maxIterations; i++) {
                var a = Math.floor(b);
                var h = a * h1 + h2;
                var k = a * k1 + k2;
                if (Math.abs(x - h / k) < tolerance) {
                    if (k === 1) return (sign * h).toString();
                    return (sign * h) + "/" + k;
                }
                h2 = h1; h1 = h;
                k2 = k1; k1 = k;
                b = 1 / (b - a);
            }
            if (k1 === 1) return (sign * h1).toString();
            return (sign * h1) + "/" + k1;
        }

        function formatNumber(num) {
            if (currentDisplayMode === "fraction") {
                return toFraction(num);
            } else {
                return parseFloat(num.toFixed(6)).toString();
            }
        }

        document.getElementById("computeBtn").addEventListener("click", computeMatrixRepresentation);

        function loadExample() {
            // Set dimensions: m=3 (domain R^3), n=2 (codomain R^2)
            document.getElementById("m").value = "3";
            document.getElementById("n").value = "2";
            generateMatrices();

            // Wait for matrices to be generated, then populate with example values
            setTimeout(() => {
                // V matrix (domain basis for R^3): 3x3 matrix with non-standard basis
                // Basis: {(1,1,0), (1,0,1), (0,1,1)}
                document.getElementById("V_0_0").value = "1";
                document.getElementById("V_0_1").value = "1";
                document.getElementById("V_0_2").value = "0";
                document.getElementById("V_1_0").value = "1";
                document.getElementById("V_1_1").value = "0";
                document.getElementById("V_1_2").value = "1";
                document.getElementById("V_2_0").value = "0";
                document.getElementById("V_2_1").value = "1";
                document.getElementById("V_2_2").value = "1";

                // A matrix (standard matrix of T: R^3 -> R^2): 2x3 matrix
                document.getElementById("A_0_0").value = "1";
                document.getElementById("A_0_1").value = "2";
                document.getElementById("A_0_2").value = "1";
                document.getElementById("A_1_0").value = "2";
                document.getElementById("A_1_1").value = "1";
                document.getElementById("A_1_2").value = "1";

                // U matrix (codomain basis for R^2): 2x2 matrix with non-standard basis
                // Basis: {(2,1), (1,1)}
                document.getElementById("U_0_0").value = "2";
                document.getElementById("U_0_1").value = "1";
                document.getElementById("U_1_0").value = "1";
                document.getElementById("U_1_1").value = "1";

                // Add example explanation
                const resultDiv = document.getElementById("result");
                resultDiv.innerHTML = `
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                        <h3 class="font-bold text-lg mb-2 text-blue-800">Example Loaded: $T: \\mathbb{R}^3 \\to \\mathbb{R}^2$ with Non-Standard Bases</h3>

                        <p class="text-gray-700 mb-2"><strong>Linear Transformation:</strong></p>
                        <p class="text-center mb-3">$$ T\\left(\\begin{bmatrix} x \\\\ y \\\\ z \\end{bmatrix}\\right) = \\begin{bmatrix} x + 2y + z \\\\ 2x + y + z \\end{bmatrix} $$</p>

                        <p class="text-gray-700 mb-2"><strong>Standard Matrix (from $T(\\mathbf{e}_1), T(\\mathbf{e}_2), T(\\mathbf{e}_3)$):</strong></p>
                        <p class="text-center mb-3">$$ \\mathbf{A} = \\begin{bmatrix} 1 & 2 & 1 \\\\ 2 & 1 & 1 \\end{bmatrix} $$</p>

                        <p class="text-gray-700 mb-2"><strong>Domain Basis $\\mathcal{B}$ for $\\mathbb{R}^3$:</strong></p>
                        <p class="text-center mb-3">$$ \\mathcal{B} = \\left\\{ \\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix}, \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}, \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix} \\right\\} $$</p>

                        <p class="text-gray-700 mb-2"><strong>Codomain Basis $\\mathcal{C}$ for $\\mathbb{R}^2$:</strong></p>
                        <p class="text-center mb-3">$$ \\mathcal{C} = \\left\\{ \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}, \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} \\right\\} $$</p>

                        <p class="text-gray-700 text-sm italic">Click "Compute" to find $\\mathbf{B} = \\mathbf{U}^{-1} \\mathbf{A} \\mathbf{V}$, the matrix representation of $T$ relative to bases $\\mathcal{B}$ and $\\mathcal{C}$.</p>
                    </div>
                `;
                renderMathInElement(resultDiv, {
                    delimiters: [
                        { left: "$$", right: "$$", display: true },
                        { left: "$", right: "$", display: false }
                    ],
                    throwOnError: false,
                    errorCallback: function(err) {
                        console.error("KaTeX rendering error in example:", err);
                    }
                });
            }, 100);
        }
    </script>
</body>

</html>
